% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ilr.R
\name{ilr_transform}
\alias{ilr_transform}
\title{Isometric log-ratio (ILR) transformation for compositional data}
\usage{
ilr_transform(X, basis = NULL, zero.method = c("none", "cmultRepl"), ...)
}
\arguments{
\item{X}{A numeric matrix or data frame. Rows = observations, columns = parts.}

\item{basis}{Optional \eqn{(D-1)\times D} numeric matrix giving the ILR
contrast basis \eqn{\Psi}. Rows are ILR coordinates, columns correspond to
parts (columns of \code{X}). If \code{NULL}, a default orthonormal Helmert
basis is constructed.}

\item{zero.method}{Character; how to handle zeros:
\itemize{
  \item \code{"none"}: require strictly positive entries; error if any
    \eqn{\le 0}.
  \item \code{"cmultRepl"}: use \code{zCompositions::cmultRepl} to perform
    multiplicative replacement of zeros.
}}

\item{...}{Additional arguments passed to \code{zCompositions::cmultRepl}
when \code{zero.method = "cmultRepl"}.}
}
\value{
A numeric matrix with \code{nrow(X)} rows and \code{ncol(X) - 1}
  columns containing ILR-transformed values. Row names of \code{X} are
  preserved. Column names are taken from \code{rownames(basis)} if present,
  otherwise \code{"ilr1"}, \code{"ilr2"}, \dots.
}
\description{
Performs the isometric log-ratio (ILR) transform on a numeric matrix or
data frame. Optionally handles zeros using \code{zCompositions::cmultRepl}.
Rows are treated as observations and columns as parts.
}
\details{
For a composition \eqn{X_i = (X_{i1}, \ldots, X_{iD})}, the ILR transform is
defined as an orthonormal rotation of the CLR coordinates:
\deqn{
  \mathrm{ilr}(X_i) = \mathrm{clr}(X_i)\, \Psi^\top,
}
where \eqn{\Psi} is a \eqn{(D-1)\times D} contrast matrix with orthonormal
rows (i.e., \eqn{\Psi \Psi^\top = I_{D-1}} and each row sums to zero).

By default, \code{ilr_transform()} constructs such a \eqn{\Psi} using a scaled
Helmert contrast matrix.
}
\examples{
## Example 1: simple positive counts (no zeros)
X <- matrix(c(10, 20, 30,
              5,  5, 10),
            nrow = 2, byrow = TRUE)
colnames(X) <- c("A", "B", "C")

ILR_X <- ilr_transform(X)
ILR_X

## Example 2: data with zeros, using zCompositions (if available)
X0 <- rbind(c(0, 2, 3),
            c(1, 1, 0),
            c(1, 1, 5))
colnames(X0) <- c("A", "B", "C")

ILR_X0 <- ilr_transform(X0, zero.method = "cmultRepl")
ILR_X0

## Example 3: user-supplied ILR basis
X3 <- matrix(c(4, 1, 2,
               1, 3, 2,
               5, 6, 1),
             nrow = 3, byrow = TRUE)
colnames(X3) <- c("A", "B", "C")

## Simple orthonormal basis for D = 3 (rows sum to zero, rows orthonormal)
Psi <- matrix(c( 1, -1,  0,
                1,  1, -2), nrow = 2, byrow = TRUE)
Psi <- diag(1 / sqrt(rowSums(Psi^2))) \%*\% Psi
rownames(Psi) <- c("ilr_AB", "ilr_AB_vs_C")
colnames(Psi) <- colnames(X3)

ILR_X3 <- ilr_transform(X3, basis = Psi)
ILR_X3

}
